# IMDb
Transforms and queries to the IMDb offline databases (https://www.imdb.com/interfaces/)

## Included Scripts
**01_tsv_to_csv_clean_fix.py** - takes original .tsv files, replaces '\N' in them, saves as .csv with correct Unicode characters.

**02_create_tables.sql** - creates tables corresponding to the cleaned-up files generated by **01_tsv_to_csv_clean_fix.py**. Pays attetion to the fact that some data in the original tables it not where it should be (title_info/title.basics is the primary table with misplaced data), e.g. IS_ADULT field has '2019' mixed in with the boolean '0' and '1', RUNTIME_MINUTES has text mixed in.

**03_copy_data_to_tables.sql** - copies data from cleaned up .csvs from **01_tsv_to_csv_clean_fix.py** into tables created by **02_create_tables.sql**.
**04_clean_tables.sql** - turns multi-valued columns into additional rows with single-valued columns. Affects things like actors' "known for" column, where multiple film ids are listed in a single column.
**05_non_obvious_stats.sql** - some simple statistics, like top 10 worse films, most popular full names, most popular languages, film types, longest series, and different job types.
